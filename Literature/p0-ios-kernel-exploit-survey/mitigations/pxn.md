# PXN（iOS 7）

## 机制是什么
PXN（Privileged Execute-Never）用于防止内核在特权态执行 userspace 映射中的代码页（避免“跳到用户态 shellcode”）。

## 对利用链的影响
- 与 W^X 类似，survey 认为现代公开 iOS 内核利用通常不依赖执行 userspace shellcode；PXN 的存在更像是“堵住传统跳板”，而不是主要博弈点。

## 参考内容摘要

**核心机制**：PXN（Privileged Execute Never，ARM 标准特性，iOS 9+）在 CPU 硬件层级禁止 EL1（kernel）执行只允许 EL0（用户态）执行的页面。即使内核改写页表，CPU 仍会拒绝在 PXN 页上执行。是对抗"内核读写页表后执行用户代码段"套路的基础防御。

**对现代利用的影响**：PXN 禁止了直接"内核执行用户代码"的路线，使得获得内核读写后不能简单地把用户 payload 标记为可执行。这迫使 exploit 要么在内核侧直接执行（ROP/JOP），要么借助特权态本身的 gadget（如 OSSerializer::serialize），要么突破内核代码本身的完整性保护（KTRR）。

**绕过现状**：大多数现代 exploit 对 PXN 的应对是设计内核侧原语（任意调用、ROP gadget），而非尝试绕过 PXN 本身。个别链通过修改 kernel 代码段转移控制流来绕过，但需要先破 KTRR。

**缓解评估**：PXN 有效防御了"用户态 shell code 注入内核"的套路，与 KTRR 协作提升代码完整性保护。

## 参考
- Survey：iOS kernel exploit mitigations / PXN
- Survey：iOS kernel exploit mitigations / PXN

# treadm1ll (LightSpeed variant)

- 目标系统: iOS 11.4.1
- CVE: （同 LightSpeed）

## 初始原语（primitive）
同 LightSpeed：race 导致 double-free/UAF，最终得到 fake port right。

## 漏洞特定利用策略（strategy）
先制造消息中 dangling OOL 指针，再逐条接收并用 IOSurface spray 重占位为假数组。

## 后续通用利用流程（subsequent exploit flow）
notification 泄露；pid_for_task 建读原语；转 fake user client + iokit_user_client_trap 任意调用；构造 fake kernel task port。

## 关键可复用技术点（techniques）
- 逐条接收+重占位提升成功率
- pid_for_task 读
- trap 任意调用

## 与缓解机制的关系（notes）
- survey 注记：PAN 启用时不可用。

## 参考
- [exploit code](https://bugs.chromium.org/p/project-zero/issues/detail?id=1577#c11)

### 参考内容摘要

**原文概述**：treadm1ll（iOS 11.4.1，A11 GPU 同漏洞另一链）。AGXMaliAccelerator 未锁定下的 UAF；并发触发导致对象被释放但引用未清；双释放后重占位注入 fake 虚表；通过虚调用进入任意调用 gadget。Exploit：①并发喷射时序击；②UAF 后跳过锁定的释放；③重占位用 ipc_kmsg；④读虚指针泄露 vtable + KASLR；⑤AGXAccelerator 重占位注入 fake vtable；⑥虚调用到任意调用。关键技术：并发 UAF + 双释放、vtable 泄露 KASLR、gadget 任意调用。展示 GPU 驱动同步问题。
- [code](https://github.com/tihmstar/treadm1ll)

# empty_list

- 目标系统: iOS 11.3.1
- CVE: CVE-2018-4243

## 初始原语（primitive）
受限写原语：越界写 8 字节 0（off-by-end zeroing）。

## 漏洞特定利用策略（strategy）
复杂 groom 让 kalloc.16 与 ipc.ports 交替并逆转 freelist；反复触发直到清零影响到后续页的 ipc_port 开头字段；再释放得到 dangling port。

## 后续通用利用流程（subsequent exploit flow）
zone GC + OOL ports array 泄露地址；pipe buffers 重分配得到可控 fake port；pid_for_task 建读原语；构造 fake kernel task port。

## 关键可复用技术点（techniques）
- 弱写原语 + 强布局
- dangling port → 泄露 → pipe 可控化

## 与缓解机制的关系（notes）
- 是“弱原语也能利用”的代表。

## 参考
- [exploit code](https://bugs.chromium.org/p/project-zero/issues/detail?id=1564#c10)

### 参考内容摘要

**原文概述**：empty_list（Ian Beer 针对 iOS 11.3.1 的 CVE-2018-4243）。受限写原语：越界写 8 字节 0（off-by-end zeroing）。Exploit 策略：①复杂 groom 让 kalloc.16 与 ipc.ports 交替并逆转 freelist；②反复触发直到清零影响到后续页的 ipc_port 开头字段；③再释放得到 dangling port；④zone GC + OOL ports array 泄露地址；⑤pipe buffers 重分配得到可控 fake port；⑥pid_for_task 建读原语；⑦构造 fake kernel task port。关键技术：弱写原语（仅 8 字节 0）+ 强布局（交替分配逆转 freelist）、dangling port → 泄露 → pipe 可控化。该链是"弱原语也能利用"的典型代表，强调堆布局的威力。
